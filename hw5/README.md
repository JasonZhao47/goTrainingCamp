### 判断崩溃机制
* 基于错误率

  给一个固定的时间片和容忍率。

  循环判断每个时间片里，请求异常率有多少。

  异常率大于容忍，就认为服务商已经崩溃了，进行切换。

  参数：错误率、时间片长度都支持自定义。
* 决策的原因

  主要是考虑到服务商的可用性。

  有容忍度，如果服务商只是暂时有问题，不必立刻就进行开销很大的切换。

### 转储加异步的容错机制
* 适合的场景

  实时要求不很高的场景，对失败有一定容忍度，但是要保证最终的数据一致性。
* 优点

  直接避免请求失败，保证一致性，业务上一定是要把这个请求最后发出去了的
* 缺点

  会有一定的延迟，因为转储再发出去要耗时间，不实时

  缺乏一种重试的机制，中间任何一步报错就没法再重试

* 改进
1. 添加监控和重试机制

   重试机制：可以每隔一段时间自动重试一次，间隔时间按指数增加
   
   监控机制：每次埋点生成日志在关键条件处，在goroutine的开始，发送请求的开始，发送完请求的返回，异常处都生成日志。

3. 判断崩溃

   还有一种思路是平均响应时间，可以结合使用，多一个判断条件。